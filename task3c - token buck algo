3C
#include <stdio.h>

int main() {
    // Step 1: Initialize token bucket parameters
    int bucket_size = 10;        // Maximum tokens that can be stored in the bucket
    int tokens = 0;              // Current number of tokens in the bucket
    int token_rate = 3;          // Rate at which tokens are generated per time unit
    int input_pkt_size[] = {4, 6, 8, 2, 1, 5}; // Incoming packet sizes
    int required_tokens = 4;     // Tokens required to process one packet
    int queue = 0;               // Packets waiting in queue (due to lack of tokens)

    // Step 2: Process each incoming packet one by one
    for (int i = 0; i < 6; i++) {
        // Generate tokens for each time interval
        tokens += token_rate;
        if (tokens > bucket_size) tokens = bucket_size; // Cap tokens at bucket size

        // Display current token status and incoming packet details
        printf("No of tokens: %d\n", tokens);
        printf("Time: %d seconds\n", i + 1);
        printf("Incoming packet size: %d\n", input_pkt_size[i]);

        // Step 3: If not enough tokens, queue the packet
        if (tokens < required_tokens) {
            printf("Not enough tokens! Queuing packet of size %d.\n", input_pkt_size[i]);
            queue += input_pkt_size[i];
        } 
        // Step 4: If enough tokens, process the packet
        else {
            tokens -= required_tokens;  // Use tokens to process the packet
            printf("Processed packet of size %d. Tokens remaining: %d\n", input_pkt_size[i], tokens);

            // Step 5: If queued packets exist and enough tokens, process them too
            if (queue > 0 && tokens >= required_tokens) {
                printf("Processing queued packet of size %d\n", queue);
                tokens -= required_tokens;
                queue = 0;  // Queue cleared after processing
            }
        }

        // Step 6: Show current bucket and queue status
        printf("Tokens in bucket: %d\n", tokens);
        printf("Packets in queue: %d\n\n", queue);
    }

    return 0;
}
